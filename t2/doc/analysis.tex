\section{Theoretical Analysis}
\label{sec:analysis}

We analyse the circuit shown in Figure~\ref{fig:rc} for t<0 using the nodal method.
The nodes are numbered according to what's shown in the picture.
In this first instance we are working in a steady state, where no current is flowing through the capacitor: we can replace it with an open circuit.
After doing this, it is clear that all the components we are working with are linear and so we will need to solve a system of linear equations to determine the initial values for the subsequent analysis.
This way, weâ€™ve ran the nodal method and solved the linear system on GNU Octave.
\subsection{Node Analysis for t<0}
Knowing that V4=0 since it is connected to the ground:
\begin{equation}
\begin{pmatrix}
1 & 0 & 0 & 0 & 0 & 0 & 0\\
-G1 & G1+G2+G3 & -G2 & -G3 & 0 & 0 & 0\\
0 & Kb+G2 & -G2 & -Kb & 0 & 0 & 0\\
-G1 & G1 & 0 & G4 & 0 & G6 & 0\\
0 & 0 & 0 & 0 & 0 & -G6-G7 & G7\\
0 & 0 & 0 & 1 & 0 & G6*Kd & -1\\
0 & -G3 & 0 & G3+G4+G5 & -G5 & G6 & 0
\end{pmatrix}
\begin{pmatrix}
V1\\
V2\\
V3\\
V5\\
V6\\
V7\\
V8
\end{pmatrix}
=
\begin{pmatrix}
Vs\\
0\\
0\\
0\\
0\\
0\\
0
\end{pmatrix}
\end{equation}
We can also easily obtain the current values in the various branches through Ohm's law. This yields the following results:
\begin{table}[h]
  \centering
  \begin{tabular}{|l|r|}
    \hline    
    {\bf Name} & {\bf Value [A and V]} \\ \hline
    \input{op_tab} 
  \end{tabular}
  \caption{Theoretical analysis results. (A variable preceded by @ is of type {\em current})}
  \label{tab:nodal}
\end{table}

\subsection{Equivalent Resistor}
In order to compute the equivalent resistor we ran a nodal analysis, making Vs=0 and replacing the capacitor with a voltage source Vx=V6-V8 as calculated in the previous step. This is made to ensure that the voltage in the capacitor is continuous since it does so in reality: this is a capacitor discharging through a resistance, any discontinuity in voltage would require an infinite amount of current. 

\begin{table}[h]
  \centering
  \begin{tabular}{|l|r|}
    \hline    
    {\bf Name} & {\bf Value [A]} \\ \hline
    \input{eq_tab} 
  \end{tabular}
  \caption{Theoretical analysis results. (A variable preceded by @ is of type {\em current})}
  \label{tab:nodal}
\end{table}

\begin{figure}[h] \centering
\includegraphics[width=0.8\linewidth]{natural.eps}
\caption{Natural solution to $V_{6}$ node voltage.}
\label{fig:current}
\end{figure}

\begin{figure}[h] \centering
\includegraphics[width=0.8\linewidth]{total.eps}
\caption{Total solution to $V_{6}$ node voltage.}
\label{fig:current}
\end{figure}

Applying the Kirchhoff Voltage Law (KVL) in the different loops, we get four different equations, which we can then solve as a matrix:
\begin{equation}
  I_D=I;
\end{equation}

\begin{equation}
  (R_1+R_3+R_4)I_A-R_3I_B-R_4I_C=-V_A;
\end{equation}

\begin{equation}
  (R_4+R_6+R_7-K_C)I_C-R_4I_A=0;
\end{equation}

\begin{equation}
  (R_3K_B-1)I_B-R_3K_BI_A=0.
\end{equation}

\begin{equation}
\begin{pmatrix}
0 & 0 & 0 & 1 \\
R1+R3+R4 & -R3 & -R4 & 0 \\
-R4 & 0 & R4+R6+R7-Kc & 0 \\
-R3Kb & R3Kb-1 & 0 & 0
\end{pmatrix}
\begin{pmatrix}
Ia\\
Ib\\
Ic\\
Id
\end{pmatrix}
=
\begin{pmatrix}
I\\
-V\\
0\\
0
\end{pmatrix}
\end{equation}


\subsection{Node Analysis}

As in the previous section, we extract a set of equations from the circuit, this time using the node method. This yields 8 equations, one for each node. Then, we can solve those 8 equations in the form of the matrix presented here.
\begin{equation}
\begin{pmatrix}
G7 & 0 & 0 & 0 & 0 & 0 & G6 & 0\\
1 & -1 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 1 & -1 & 0\\
0 & 0 & 0 & -G2 & G1+G2+G3 & -G1 & 0 & -G3\\
0 & 0 & G5 & 0 & G3 & 0 & G4+G6 & -G3-G4-G5\\
1 & 0 & 0 & 0 & 0 & 0& Kc*G6 & -1\\
0 & 0 & 0 & 0 & G1 & -G1 & -G4-G6 & G4\\
0 & 0 & 0 & -G2 & Kb+G2 & 0 & 0 & -Kb
\end{pmatrix}
\begin{pmatrix}
V1\\
V2\\
V3\\
V4\\
V5\\
V6\\
V7\\
V8
\end{pmatrix}
=
\begin{pmatrix}
0\\
0\\
V\\
0\\
I\\
0\\
0\\
0
\end{pmatrix}
\end{equation}

